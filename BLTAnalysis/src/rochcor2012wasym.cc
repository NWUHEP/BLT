#include <TLorentzVector.h>
#include "BLT/BLTAnalysis/interface/rochcor2012wasym.h"


const double rochcor2012::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					 0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2012::anetabin[13] = {0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2012::dcor_bf[16][24]={{0.000103121,-0.000033184,-0.000027999,-0.000035827,0.000016634,0.000045747,0.000062738,0.000035750,0.000064626,0.000072408,0.000064243,0.000028762,0.000039303,0.000036888,0.000042138,0.000059256,0.000058712,0.000037128,0.000040994,0.000020202,0.000004152,0.000025703,-0.000049698,-0.000091875},
					   {-0.000107139,0.000037191,-0.000014325,0.000023665,0.000073313,0.000036366,0.000033021,0.000046706,0.000048981,0.000082638,0.000072556,0.000060819,0.000057186,0.000077719,0.000047084,0.000030399,0.000039153,0.000037809,0.000024064,0.000040582,0.000011870,0.000011364,-0.000006540,0.000027043},
{0.000052205,0.000041028,0.000064794,0.000038146,0.000021338,0.000013556,0.000015153,0.000070979,0.000068553,0.000079037,0.000073626,0.000052197,0.000061603,0.000047068,0.000022685,0.000019518,0.000034044,0.000024397,0.000025469,0.000032872,0.000031123,0.000078095,-0.000009109,0.000079120},
{0.000015727,0.000019762,0.000017747,0.000022224,0.000039981,0.000037027,0.000068723,0.000046877,0.000083702,0.000072557,0.000081322,0.000085587,0.000109689,0.000069756,0.000078883,0.000067050,0.000040065,0.000087713,0.000046731,0.000017764,0.000036153,0.000018848,0.000059938,0.000036298},
{0.000078918,0.000050346,0.000037304,0.000017683,0.000010165,0.000067067,0.000048842,0.000031262,0.000055989,0.000055987,0.000062450,0.000068129,0.000077078,0.000080807,0.000064169,0.000061488,0.000037391,0.000060629,0.000040654,0.000025280,0.000007258,0.000011607,0.000046433,0.000016221},
{-0.000020592,0.000015516,-0.000035442,0.000001115,0.000020989,0.000018990,0.000071297,0.000049975,0.000072312,0.000047411,0.000076973,0.000039969,0.000096879,0.000071174,0.000049274,0.000042473,0.000025430,0.000053025,0.000060737,-0.000003118,0.000018656,0.000036007,-0.000027292,0.000072619},
{-0.000028806,-0.000033337,-0.000001225,-0.000003201,0.000011640,0.000028452,0.000038850,0.000051637,0.000040514,0.000042204,0.000053195,0.000067612,0.000086136,0.000059083,0.000062319,0.000024323,0.000023234,-0.000001474,0.000047938,0.000006924,0.000009902,0.000004992,0.000017201,-0.000122331},
{-0.000005231,-0.000032734,-0.000025448,0.000038898,0.000026054,0.000034033,0.000052268,0.000038473,0.000026349,0.000074355,0.000052120,0.000060271,0.000009777,0.000066189,0.000051209,0.000024372,0.000054584,0.000056021,-0.000003146,-0.000020011,-0.000004389,0.000013931,0.000046616,-0.000069633},
{-0.000032084,-0.000077381,-0.000044409,-0.000031974,0.000007012,0.000036144,0.000056070,0.000054867,0.000041473,0.000038478,0.000027339,0.000087024,0.000061299,0.000059508,0.000026098,0.000054984,0.000056346,0.000006810,0.000017820,0.000047177,-0.000005738,0.000032765,-0.000133306,0.000015324},
{-0.000162968,0.000017364,-0.000046388,-0.000029114,-0.000001031,-0.000013002,0.000033422,0.000044717,0.000052240,0.000069467,0.000116274,0.000071915,0.000113372,0.000047433,0.000042332,0.000039374,0.000042986,0.000043229,0.000023376,0.000016216,-0.000051139,-0.000056262,-0.000017468,0.000042328},
{0.000092759,-0.000012375,0.000012903,0.000029038,-0.000005285,0.000044530,-0.000007465,0.000029395,0.000061022,0.000053998,0.000105354,0.000132394,0.000072446,0.000077338,0.000064141,0.000033592,0.000035847,0.000041495,0.000052223,0.000034835,0.000040481,0.000009767,0.000008242,-0.000041038},
{-0.000023387,0.000004854,-0.000017808,-0.000008100,-0.000001108,0.000035703,0.000001219,0.000023261,0.000062964,0.000040623,0.000093260,0.000097310,0.000051207,0.000064599,0.000060248,0.000073299,0.000062802,0.000008410,0.000031940,0.000016371,0.000024798,-0.000000568,-0.000054741,0.000081117},
{0.000035936,-0.000029135,-0.000030596,0.000004942,0.000037337,-0.000012578,0.000044843,0.000031603,0.000051372,0.000074956,0.000060730,0.000083147,0.000069196,0.000090308,0.000056496,0.000066814,0.000052140,0.000017139,0.000021023,0.000046742,-0.000048719,-0.000005139,-0.000004051,0.000001170},
{-0.000107464,-0.000027298,-0.000014544,-0.000035266,-0.000007083,0.000008757,0.000029375,0.000054961,0.000054518,0.000051780,0.000088679,0.000069522,0.000085453,0.000072590,0.000057398,0.000028394,0.000051544,0.000072682,0.000031503,0.000020138,0.000040521,-0.000018738,0.000002522,-0.000035047},
{0.000031437,-0.000069675,-0.000032390,-0.000007662,-0.000007089,0.000032425,0.000036716,0.000030349,0.000042721,0.000065648,0.000094824,0.000090694,0.000081049,0.000052225,0.000072527,0.000060222,0.000034073,0.000074515,0.000063319,0.000069910,-0.000007735,0.000107422,0.000030091,0.000050660},
{-0.000032978,0.000045043,0.000044669,-0.000012848,0.000036072,0.000010517,0.000053871,0.000072773,0.000033047,0.000060922,0.000064558,0.000049035,0.000041353,0.000085513,0.000046405,0.000035998,0.000053161,0.000001834,-0.000002740,0.000013540,0.000033950,0.000024469,-0.000006106,0.000036970}};

const double rochcor2012::dcor_ma[16][24]={{0.000123714,0.000026435,0.000032807,-0.000029001,-0.000026292,-0.000049000,-0.000039139,-0.000033191,-0.000039016,-0.000037144,-0.000061507,-0.000056891,-0.000055192,-0.000043950,-0.000053734,-0.000066228,-0.000066074,-0.000062464,-0.000088650,-0.000005157,0.000120385,0.000246810,0.000492272,0.000605014},
{0.000493917,0.000233256,0.000153061,0.000039260,0.000030736,0.000022154,-0.000022684,-0.000006198,-0.000009446,-0.000065668,-0.000036369,-0.000063181,-0.000040683,-0.000048309,-0.000058138,-0.000015175,0.000013829,0.000019065,0.000037821,0.000098582,0.000115125,0.000297309,0.000465223,0.000540920},
{0.000576092,0.000416769,0.000276053,0.000105282,0.000092942,0.000003039,0.000010733,-0.000010393,-0.000023709,-0.000010812,-0.000025954,-0.000033847,0.000001237,-0.000045384,0.000017374,-0.000019181,0.000022208,0.000067764,0.000079759,0.000092473,0.000123803,0.000102719,0.000101893,0.000252328},
{0.000742678,0.000403951,0.000190146,0.000071053,0.000059060,0.000046528,0.000004539,0.000006805,0.000001734,-0.000002586,0.000010398,-0.000020016,0.000003833,0.000024061,0.000001872,0.000030144,0.000017887,0.000035064,0.000082258,0.000044446,0.000048788,0.000004530,-0.000062286,0.000007819},
{0.000038469,0.000033687,0.000038804,-0.000013248,-0.000006882,0.000024147,0.000038762,0.000030805,0.000055381,0.000002393,0.000041917,0.000021445,0.000030218,0.000024109,0.000029934,0.000021526,0.000027019,-0.000000611,-0.000013497,0.000014881,-0.000044841,-0.000091950,-0.000261741,-0.000584166},
{-0.000070844,-0.000064627,-0.000036853,-0.000039738,-0.000008152,-0.000017745,0.000057810,0.000038922,0.000039542,0.000076035,0.000043576,0.000049383,0.000072665,0.000033432,0.000042372,0.000033097,0.000043720,-0.000023402,-0.000032546,-0.000053135,-0.000103298,-0.000105545,-0.000159387,-0.000010174},
{-0.000436783,-0.000328245,-0.000115249,0.000047589,0.000057816,0.000024594,0.000020394,0.000010775,0.000062308,0.000042847,0.000083715,0.000080250,0.000076308,0.000051651,0.000066583,0.000015061,0.000013806,0.000000377,-0.000047873,-0.000091222,-0.000116906,-0.000135801,-0.000239844,-0.000261047},
{-0.000564332,-0.000351178,-0.000203630,-0.000004602,0.000108775,0.000154092,0.000122626,0.000074684,0.000082120,0.000048258,0.000068143,0.000080509,0.000098589,0.000051098,0.000067633,0.000052894,0.000067880,0.000046070,0.000048314,-0.000013349,-0.000060711,-0.000094676,-0.000135712,-0.000257970},
{-0.000542918,-0.000304198,-0.000123993,0.000005917,0.000098131,0.000112967,0.000123689,0.000103447,0.000059879,0.000055106,0.000059869,0.000086014,0.000070566,0.000082065,0.000058021,0.000046241,0.000048241,0.000060286,0.000100437,0.000118339,0.000058582,0.000025054,0.000033719,-0.000115085},
{-0.000172367,-0.000057731,0.000071762,0.000170597,0.000140030,0.000156781,0.000066119,0.000085580,0.000041154,0.000032657,0.000057273,0.000067728,0.000046180,0.000040934,0.000054036,0.000058658,0.000078329,0.000106558,0.000159355,0.000177052,0.000132254,0.000062089,0.000024517,0.000118552},
{-0.000053149,-0.000075116,-0.000007885,0.000109570,0.000086116,0.000057869,0.000028366,0.000014485,0.000034635,0.000027287,0.000059776,0.000032905,0.000028837,0.000070758,0.000026587,0.000022782,0.000055263,0.000051691,0.000108426,0.000153226,0.000198910,0.000103476,0.000078583,0.000201415},
{-0.000134995,-0.000010942,-0.000059023,-0.000048716,0.000013189,0.000010342,-0.000022055,-0.000004134,-0.000017884,-0.000013157,-0.000003912,0.000001881,0.000003896,-0.000018505,-0.000008797,0.000004492,0.000003270,0.000028947,-0.000020382,0.000038261,0.000077346,0.000118387,0.000146882,-0.000022623},
{0.000173910,-0.000010901,0.000009160,-0.000022700,-0.000029860,-0.000029132,-0.000032577,-0.000033618,-0.000039691,0.000004570,-0.000039255,-0.000044460,-0.000029263,-0.000030645,-0.000049430,-0.000020241,-0.000011132,-0.000031872,-0.000046248,-0.000060351,-0.000008316,-0.000018393,0.000021449,0.000329285},
{0.000363241,0.000230560,0.000092446,-0.000043273,-0.000067011,-0.000085464,-0.000044422,-0.000047808,-0.000039851,-0.000032540,-0.000038136,-0.000044111,-0.000040280,-0.000053657,-0.000080959,-0.000086095,-0.000072219,-0.000084311,-0.000103170,-0.000105939,-0.000137204,-0.000047333,0.000079944,0.000309779},
{-0.000102287,0.000062505,0.000027465,-0.000024762,0.000000837,-0.000065197,-0.000047376,-0.000039034,-0.000061766,-0.000030689,-0.000045923,-0.000073120,-0.000067979,-0.000077851,-0.000070878,-0.000097583,-0.000135528,-0.000125486,-0.000158149,-0.000145817,-0.000094094,0.000053858,0.000152740,0.000258611},
{0.000072027,0.000120614,0.000067663,-0.000018480,-0.000017227,-0.000064085,-0.000054305,-0.000051956,-0.000051777,-0.000052608,-0.000075253,-0.000073975,-0.000056380,-0.000084476,-0.000072880,-0.000100888,-0.000104699,-0.000110420,-0.000147338,-0.000129636,-0.000087623,0.000111000,0.000419722,0.000625610}};

const double rochcor2012::mcor_bf[16][24]={{-0.000106744,-0.000067920,-0.000041007,-0.000049693,-0.000038597,-0.000019791,-0.000005996,-0.000012672,-0.000013520,-0.000008145,-0.000007897,-0.000000897,-0.000007271,-0.000008365,-0.000008871,-0.000010879,-0.000010421,-0.000012172,-0.000012700,-0.000022519,-0.000039153,-0.000070524,-0.000047368,-0.000122973},
{-0.000119181,-0.000047397,-0.000040342,-0.000037452,-0.000030056,-0.000024681,-0.000015587,-0.000013915,-0.000007339,0.000004601,-0.000002235,-0.000004177,-0.000006360,-0.000004774,0.000000100,-0.000014586,-0.000018410,-0.000008968,-0.000021335,-0.000024713,-0.000044272,-0.000056699,-0.000083293,-0.000106005},
{-0.000070732,-0.000071235,-0.000040604,-0.000039145,-0.000029841,-0.000021538,-0.000018135,0.000004579,-0.000010463,-0.000006679,-0.000004860,-0.000002512,-0.000009679,-0.000006153,-0.000005826,-0.000018084,-0.000016373,-0.000021969,-0.000028993,-0.000037947,-0.000044277,-0.000041550,-0.000078750,-0.000075538},
{-0.000050011,-0.000052684,-0.000041152,-0.000034703,-0.000033571,-0.000033765,-0.000005792,-0.000013396,-0.000007327,-0.000004397,-0.000000256,-0.000002997,-0.000001389,-0.000007759,0.000001693,-0.000019440,-0.000016564,-0.000010512,-0.000031918,-0.000034260,-0.000041623,-0.000032766,-0.000030982,-0.000086908},
{-0.000110631,-0.000044344,-0.000051990,-0.000027440,-0.000037404,-0.000032272,-0.000006704,-0.000013032,-0.000009483,-0.000010405,-0.000019482,-0.000001500,-0.000013715,-0.000007255,-0.000004076,-0.000014136,-0.000012648,-0.000016424,-0.000031190,-0.000018606,-0.000038682,-0.000055161,-0.000070844,-0.000099692},
{-0.000079371,-0.000068898,-0.000061950,-0.000043053,-0.000039878,-0.000009992,-0.000009296,-0.000018713,-0.000014346,-0.000006309,-0.000010300,-0.000012150,-0.000002674,-0.000005397,-0.000013087,-0.000009452,-0.000009313,-0.000001725,-0.000014747,-0.000020715,-0.000052358,-0.000030041,-0.000086582,-0.000108967},
{-0.000113105,-0.000068574,-0.000049214,-0.000025102,-0.000010126,-0.000012445,-0.000005636,-0.000001566,-0.000008387,-0.000009714,-0.000010363,0.000000720,0.000011941,-0.000007132,-0.000007511,-0.000016773,-0.000021479,-0.000010654,-0.000022715,-0.000034085,-0.000038249,-0.000045919,-0.000080932,-0.000118191},
{-0.000089264,-0.000081697,-0.000029651,-0.000028402,-0.000027653,-0.000018224,-0.000009308,-0.000014697,-0.000000182,-0.000005368,-0.000005812,-0.000007986,-0.000003969,-0.000009702,-0.000010975,0.000000836,-0.000016877,-0.000014026,-0.000013962,-0.000022464,-0.000034880,-0.000049596,-0.000080658,-0.000128731},
{-0.000095181,-0.000061457,-0.000037267,-0.000021582,-0.000021119,-0.000018406,0.000003029,-0.000000651,-0.000010915,0.000000643,-0.000010667,-0.000005328,-0.000003034,-0.000004087,-0.000009321,-0.000004609,-0.000005293,-0.000014104,-0.000002747,-0.000030001,-0.000031877,-0.000040900,-0.000058034,-0.000078475},
{-0.000073361,-0.000078645,-0.000037295,-0.000034081,-0.000024898,-0.000006815,-0.000010313,-0.000006227,-0.000006610,-0.000010304,-0.000001093,0.000003581,0.000000360,-0.000003375,-0.000001713,-0.000009168,-0.000009253,-0.000001357,-0.000015544,-0.000034491,-0.000028366,-0.000031208,-0.000094160,-0.000083452},
{-0.000066955,-0.000022098,-0.000040195,-0.000047728,-0.000028860,-0.000031384,-0.000023187,-0.000018220,-0.000009537,-0.000009803,0.000006389,0.000006222,-0.000001138,-0.000013751,-0.000005059,-0.000007072,-0.000015165,-0.000014501,-0.000021283,-0.000039728,-0.000028936,-0.000058438,-0.000081988,-0.000134543},
{-0.000082631,-0.000074706,-0.000040588,-0.000044598,-0.000028594,-0.000031354,-0.000013808,-0.000008552,-0.000003287,0.000001802,-0.000006353,-0.000000214,-0.000007270,-0.000015821,0.000000679,-0.000006758,-0.000012350,-0.000020603,-0.000022273,-0.000031456,-0.000028814,-0.000045981,-0.000053855,-0.000073427},
{-0.000077970,-0.000047723,-0.000052885,-0.000040580,-0.000030118,-0.000021553,-0.000018148,-0.000016794,-0.000001902,-0.000009291,-0.000005719,-0.000000244,0.000011115,-0.000001609,0.000002760,-0.000003369,-0.000007222,-0.000015127,-0.000017147,-0.000048811,-0.000042876,-0.000059954,-0.000046903,-0.000095045},
{-0.000096416,-0.000071069,-0.000044276,-0.000037008,-0.000035822,-0.000016957,-0.000014692,-0.000008188,-0.000003215,0.000001988,-0.000008262,-0.000002084,-0.000004009,-0.000000040,0.000001092,-0.000012498,-0.000022829,-0.000012702,-0.000021645,-0.000015359,-0.000026660,-0.000036013,-0.000066230,-0.000117075},
{-0.000113406,-0.000056471,-0.000052513,-0.000043035,-0.000038022,-0.000045692,-0.000022739,-0.000006641,-0.000017080,-0.000005690,0.000000191,-0.000004201,-0.000002080,-0.000002507,-0.000007221,0.000002101,-0.000007157,-0.000008825,-0.000013288,-0.000019800,-0.000045398,-0.000028582,-0.000075127,-0.000090403},
{-0.000065292,-0.000065012,-0.000053921,-0.000042858,-0.000033820,-0.000013555,-0.000008470,-0.000012001,-0.000006305,-0.000003421,0.000002865,-0.000000012,0.000005309,-0.000000997,-0.000005173,-0.000011618,-0.000008374,-0.000022968,-0.000018393,-0.000040154,-0.000039708,-0.000046659,-0.000070494,-0.000110825}};

const double rochcor2012::mcor_ma[16][24]={{0.000389661,0.000334287,0.000168130,0.000050748,-0.000005360,-0.000026176,-0.000045875,-0.000044293,-0.000056696,-0.000053420,-0.000058227,-0.000060372,-0.000055389,-0.000055225,-0.000060788,-0.000044854,-0.000059561,-0.000074370,-0.000054861,-0.000045598,-0.000057589,-0.000091223,-0.000055485,0.000048262},
{0.000259530,0.000172400,0.000166325,0.000066461,0.000002776,-0.000039143,-0.000045790,-0.000056782,-0.000056508,-0.000060587,-0.000055906,-0.000060560,-0.000063146,-0.000051000,-0.000058297,-0.000063633,-0.000072517,-0.000097179,-0.000137750,-0.000130420,-0.000018929,0.000186434,0.000288384,0.000351962},
{0.000538845,0.000129134,-0.000012068,-0.000015463,-0.000015410,-0.000042215,-0.000050049,-0.000050244,-0.000064661,-0.000050669,-0.000048628,-0.000047947,-0.000047866,-0.000046862,-0.000047956,-0.000045689,-0.000041500,-0.000040433,-0.000029634,0.000010741,0.000115664,0.000317982,0.000453968,0.000478262},
{-0.000086811,0.000076123,0.000000746,-0.000068899,-0.000074535,-0.000071174,-0.000068371,-0.000036585,-0.000039925,-0.000037850,-0.000019953,-0.000035586,-0.000030820,-0.000028364,-0.000029520,-0.000015549,-0.000010587,-0.000001891,0.000012816,0.000033329,0.000006968,-0.000040213,-0.000066404,0.000021554},
{0.000013909,-0.000067741,-0.000108824,-0.000087190,-0.000067892,-0.000069673,-0.000031344,-0.000019434,-0.000004789,-0.000008775,-0.000010799,-0.000007483,-0.000007133,-0.000003714,0.000001497,0.000011736,0.000007826,0.000024896,0.000042474,0.000045254,-0.000015909,-0.000143456,-0.000281748,-0.000320281},
{0.000098725,-0.000009617,-0.000006775,0.000009518,0.000038462,0.000056070,0.000033325,0.000012869,0.000017449,0.000023998,0.000015186,0.000005030,0.000015229,0.000018380,0.000027457,0.000029127,0.000028186,0.000047409,0.000043734,0.000080740,0.000105098,0.000189432,0.000197726,0.000099096},
{0.000212134,0.000255835,0.000233282,0.000211222,0.000150249,0.000126051,0.000070272,0.000063308,0.000038450,0.000045055,0.000045993,0.000043980,0.000043174,0.000049758,0.000048714,0.000043375,0.000048122,0.000069655,0.000068885,0.000072135,0.000109082,0.000096429,0.000024627,0.000031904},
{0.000169241,0.000227601,0.000221864,0.000168841,0.000114554,0.000101263,0.000070398,0.000068072,0.000063050,0.000055922,0.000046427,0.000048287,0.000047015,0.000046305,0.000054367,0.000049205,0.000060792,0.000051670,0.000078445,0.000115239,0.000148975,0.000221017,0.000276513,0.000220549},
{0.000326122,0.000296785,0.000232975,0.000153755,0.000107999,0.000085063,0.000078041,0.000074391,0.000062573,0.000059206,0.000052983,0.000057939,0.000059524,0.000055983,0.000058452,0.000050044,0.000065940,0.000067205,0.000087638,0.000131732,0.000111830,0.000101287,0.000142147,0.000201443},
{0.000127388,0.000118932,0.000141929,0.000114502,0.000084353,0.000079902,0.000073584,0.000063773,0.000061618,0.000066898,0.000053926,0.000060123,0.000047270,0.000053372,0.000047922,0.000049317,0.000052380,0.000058876,0.000048247,0.000071304,0.000108754,0.000177160,0.000279096,0.000451944},
{-0.000198773,-0.000141182,-0.000054330,0.000017544,0.000039039,0.000026041,0.000034481,0.000038663,0.000049748,0.000048808,0.000048310,0.000048983,0.000052956,0.000058504,0.000035850,0.000029912,0.000037794,0.000023655,0.000004525,0.000004674,-0.000010984,-0.000019531,-0.000002546,-0.000020051},
{-0.000720522,-0.000432177,-0.000244121,-0.000098073,-0.000041960,-0.000008476,0.000013814,0.000016593,0.000028920,0.000023782,0.000027594,0.000034712,0.000025260,0.000035553,0.000037226,0.000037060,0.000031067,0.000022931,0.000010145,0.000018180,0.000033890,0.000123477,0.000277194,0.000523382},
{-0.000877614,-0.000547418,-0.000296332,-0.000105284,-0.000038978,-0.000019992,-0.000006154,-0.000004580,-0.000001065,-0.000001270,0.000012213,0.000011457,0.000014207,0.000007798,0.000007346,0.000011361,0.000008385,0.000019249,0.000022976,0.000014743,0.000001461,-0.000045032,-0.000092882,0.000062883},
{-0.000201464,0.000032871,0.000026215,-0.000014473,-0.000038129,-0.000033112,-0.000006358,-0.000034388,-0.000024698,-0.000020282,-0.000022893,-0.000011417,-0.000019194,-0.000023310,-0.000016644,-0.000028211,-0.000017833,-0.000035382,-0.000025710,-0.000047387,-0.000026152,0.000013831,0.000040978,-0.000113909},
{0.000169309,0.000030329,-0.000000031,-0.000023731,-0.000028315,-0.000037755,-0.000040838,-0.000069298,-0.000048927,-0.000046175,-0.000034446,-0.000046321,-0.000030030,-0.000036245,-0.000044653,-0.000038387,-0.000040778,-0.000031395,-0.000036902,-0.000052727,-0.000102686,-0.000215798,-0.000309248,-0.000370633},
{0.000422834,0.000377419,0.000182696,0.000035710,-0.000030793,-0.000060548,-0.000067309,-0.000054170,-0.000061863,-0.000057930,-0.000060149,-0.000049923,-0.000057540,-0.000056568,-0.000057561,-0.000062448,-0.000051290,-0.000050915,-0.000024977,-0.000057640,-0.000151605,-0.000325578,-0.000446228,-0.000527868}};

const double rochcor2012::dcor_bfer[16][24]={{0.000072281,0.000063719,0.000043533,0.000041187,0.000042514,0.000039559,0.000037891,0.000037201,0.000035371,0.000035143,0.000035626,0.000035553,0.000035197,0.000035447,0.000034901,0.000035461,0.000037497,0.000038223,0.000039897,0.000042480,0.000044576,0.000043540,0.000063107,0.000069196},
{0.000073948,0.000064376,0.000044125,0.000044136,0.000041282,0.000038304,0.000037087,0.000036078,0.000034757,0.000034463,0.000034607,0.000034527,0.000034642,0.000034600,0.000034434,0.000034974,0.000036291,0.000037279,0.000039082,0.000041697,0.000038657,0.000041433,0.000058427,0.000064536},
{0.000063120,0.000057452,0.000040687,0.000039413,0.000041323,0.000039059,0.000037372,0.000036635,0.000035275,0.000034708,0.000035663,0.000035245,0.000035200,0.000035883,0.000034928,0.000035576,0.000036890,0.000038570,0.000039911,0.000042029,0.000039196,0.000041047,0.000057954,0.000064521},
{0.000064886,0.000058903,0.000040761,0.000039385,0.000041900,0.000038819,0.000037513,0.000036753,0.000035221,0.000034864,0.000036045,0.000035576,0.000035254,0.000035600,0.000034657,0.000035030,0.000036793,0.000037880,0.000039727,0.000042433,0.000039722,0.000041040,0.000059375,0.000065417},
{0.000062691,0.000059991,0.000041394,0.000041166,0.000041463,0.000038619,0.000037285,0.000036811,0.000035124,0.000034609,0.000035575,0.000035381,0.000035140,0.000035587,0.000034626,0.000035252,0.000036851,0.000037941,0.000040391,0.000044578,0.000039320,0.000041112,0.000058322,0.000063367},
{0.000067896,0.000062311,0.000042316,0.000043066,0.000040930,0.000038340,0.000036842,0.000036090,0.000034751,0.000034422,0.000035315,0.000034730,0.000034618,0.000035057,0.000034043,0.000034776,0.000035789,0.000037226,0.000038473,0.000041170,0.000038670,0.000040909,0.000058884,0.000063855},
{0.000064055,0.000059979,0.000041545,0.000042529,0.000041215,0.000038668,0.000036990,0.000036192,0.000034675,0.000034291,0.000034829,0.000034734,0.000034704,0.000034821,0.000033956,0.000034650,0.000035932,0.000036882,0.000038309,0.000040804,0.000038160,0.000041011,0.000058020,0.000063025},
{0.000060977,0.000057251,0.000040677,0.000039110,0.000041585,0.000039113,0.000037726,0.000037005,0.000035155,0.000034524,0.000035414,0.000035499,0.000035479,0.000035273,0.000034825,0.000035036,0.000037345,0.000037901,0.000039687,0.000043234,0.000039166,0.000040647,0.000057122,0.000061493},
{0.000068235,0.000063968,0.000044411,0.000046856,0.000043354,0.000039547,0.000038033,0.000037190,0.000035275,0.000035266,0.000035742,0.000035729,0.000035708,0.000035864,0.000034976,0.000035275,0.000036991,0.000037767,0.000039501,0.000042226,0.000044918,0.000044596,0.000066028,0.000075568},
{0.000062898,0.000058485,0.000041709,0.000040368,0.000042220,0.000039611,0.000037831,0.000036487,0.000034842,0.000034293,0.000035598,0.000034433,0.000034550,0.000034362,0.000033944,0.000034518,0.000035840,0.000036965,0.000038482,0.000040717,0.000038747,0.000041351,0.000058474,0.000065893},
{0.000061802,0.000057026,0.000040864,0.000039119,0.000041304,0.000038873,0.000037852,0.000036198,0.000034700,0.000034445,0.000042243,0.000034680,0.000034955,0.000035535,0.000034888,0.000034801,0.000036060,0.000037408,0.000038586,0.000040961,0.000044957,0.000041765,0.000058432,0.000062791},
{0.000063045,0.000058430,0.000040817,0.000039383,0.000041634,0.000038372,0.000037169,0.000036586,0.000034620,0.000034269,0.000037001,0.000034846,0.000034930,0.000042061,0.000034495,0.000035038,0.000037842,0.000038048,0.000039126,0.000041654,0.000038485,0.000040919,0.000058822,0.000063009},
{0.000061590,0.000057832,0.000041341,0.000041285,0.000041410,0.000038543,0.000037398,0.000036818,0.000034958,0.000034442,0.000035444,0.000035000,0.000034948,0.000042143,0.000034383,0.000034946,0.000036680,0.000037457,0.000038816,0.000041711,0.000038907,0.000041071,0.000057392,0.000061876},
{0.000063747,0.000059215,0.000042071,0.000040089,0.000041467,0.000038795,0.000037480,0.000036304,0.000034999,0.000034442,0.000034718,0.000034595,0.000034587,0.000034668,0.000034522,0.000034911,0.000036046,0.000037206,0.000038699,0.000041147,0.000038204,0.000040820,0.000058587,0.000064233},
{0.000064221,0.000060200,0.000042373,0.000043644,0.000040972,0.000038696,0.000037413,0.000036077,0.000034900,0.000034188,0.000034940,0.000034544,0.000034392,0.000034516,0.000033921,0.000034517,0.000035634,0.000037056,0.000040034,0.000043193,0.000038520,0.000040414,0.000057542,0.000062267},
{0.000062873,0.000057662,0.000041341,0.000039771,0.000041648,0.000038702,0.000037417,0.000036818,0.000035118,0.000034938,0.000035459,0.000035276,0.000035227,0.000035370,0.000034621,0.000035262,0.000037247,0.000037742,0.000039507,0.000042362,0.000039007,0.000040945,0.000057495,0.000062116}};

const double rochcor2012::dcor_maer[16][24]={{0.000072281,0.000063719,0.000043533,0.000041187,0.000042514,0.000039559,0.000037891,0.000037201,0.000035371,0.000035143,0.000035626,0.000035553,0.000035197,0.000035447,0.000034901,0.000035461,0.000037497,0.000038223,0.000039897,0.000042480,0.000044576,0.000043540,0.000063107,0.000069196},
{0.000073948,0.000064376,0.000044125,0.000044136,0.000041282,0.000038304,0.000037087,0.000036078,0.000034757,0.000034463,0.000034607,0.000034527,0.000034642,0.000034600,0.000034434,0.000034974,0.000036291,0.000037279,0.000039082,0.000041697,0.000038657,0.000041433,0.000058427,0.000064536},
{0.000063120,0.000057452,0.000040687,0.000039413,0.000041323,0.000039059,0.000037372,0.000036635,0.000035275,0.000034708,0.000035663,0.000035245,0.000035200,0.000035883,0.000034928,0.000035576,0.000036890,0.000038570,0.000039911,0.000042029,0.000039196,0.000041047,0.000057954,0.000064521},
{0.000064886,0.000058903,0.000040761,0.000039385,0.000041900,0.000038819,0.000037513,0.000036753,0.000035221,0.000034864,0.000036045,0.000035576,0.000035254,0.000035600,0.000034657,0.000035030,0.000036793,0.000037880,0.000039727,0.000042433,0.000039722,0.000041040,0.000059375,0.000065417},
{0.000062691,0.000059991,0.000041394,0.000041166,0.000041463,0.000038619,0.000037285,0.000036811,0.000035124,0.000034609,0.000035575,0.000035381,0.000035140,0.000035587,0.000034626,0.000035252,0.000036851,0.000037941,0.000040391,0.000044578,0.000039320,0.000041112,0.000058322,0.000063367},
{0.000067896,0.000062311,0.000042316,0.000043066,0.000040930,0.000038340,0.000036842,0.000036090,0.000034751,0.000034422,0.000035315,0.000034730,0.000034618,0.000035057,0.000034043,0.000034776,0.000035789,0.000037226,0.000038473,0.000041170,0.000038670,0.000040909,0.000058884,0.000063855},
{0.000064055,0.000059979,0.000041545,0.000042529,0.000041215,0.000038668,0.000036990,0.000036192,0.000034675,0.000034291,0.000034829,0.000034734,0.000034704,0.000034821,0.000033956,0.000034650,0.000035932,0.000036882,0.000038309,0.000040804,0.000038160,0.000041011,0.000058020,0.000063025},
{0.000060977,0.000057251,0.000040677,0.000039110,0.000041585,0.000039113,0.000037726,0.000037005,0.000035155,0.000034524,0.000035414,0.000035499,0.000035479,0.000035273,0.000034825,0.000035036,0.000037345,0.000037901,0.000039687,0.000043234,0.000039166,0.000040647,0.000057122,0.000061493},
{0.000068235,0.000063968,0.000044411,0.000046856,0.000043354,0.000039547,0.000038033,0.000037190,0.000035275,0.000035266,0.000035742,0.000035729,0.000035708,0.000035864,0.000034976,0.000035275,0.000036991,0.000037767,0.000039501,0.000042226,0.000044918,0.000044596,0.000066028,0.000075568},
{0.000062898,0.000058485,0.000041709,0.000040368,0.000042220,0.000039611,0.000037831,0.000036487,0.000034842,0.000034293,0.000035598,0.000034433,0.000034550,0.000034362,0.000033944,0.000034518,0.000035840,0.000036965,0.000038482,0.000040717,0.000038747,0.000041351,0.000058474,0.000065893},
{0.000061802,0.000057026,0.000040864,0.000039119,0.000041304,0.000038873,0.000037852,0.000036198,0.000034700,0.000034445,0.000042243,0.000034680,0.000034955,0.000035535,0.000034888,0.000034801,0.000036060,0.000037408,0.000038586,0.000040961,0.000044957,0.000041765,0.000058432,0.000062791},
{0.000063045,0.000058430,0.000040817,0.000039383,0.000041634,0.000038372,0.000037169,0.000036586,0.000034620,0.000034269,0.000037001,0.000034846,0.000034930,0.000042061,0.000034495,0.000035038,0.000037842,0.000038048,0.000039126,0.000041654,0.000038485,0.000040919,0.000058822,0.000063009},
{0.000061590,0.000057832,0.000041341,0.000041285,0.000041410,0.000038543,0.000037398,0.000036818,0.000034958,0.000034442,0.000035444,0.000035000,0.000034948,0.000042143,0.000034383,0.000034946,0.000036680,0.000037457,0.000038816,0.000041711,0.000038907,0.000041071,0.000057392,0.000061876},
{0.000063747,0.000059215,0.000042071,0.000040089,0.000041467,0.000038795,0.000037480,0.000036304,0.000034999,0.000034442,0.000034718,0.000034595,0.000034587,0.000034668,0.000034522,0.000034911,0.000036046,0.000037206,0.000038699,0.000041147,0.000038204,0.000040820,0.000058587,0.000064233},
{0.000064221,0.000060200,0.000042373,0.000043644,0.000040972,0.000038696,0.000037413,0.000036077,0.000034900,0.000034188,0.000034940,0.000034544,0.000034392,0.000034516,0.000033921,0.000034517,0.000035634,0.000037056,0.000040034,0.000043193,0.000038520,0.000040414,0.000057542,0.000062267},
{0.000062873,0.000057662,0.000041341,0.000039771,0.000041648,0.000038702,0.000037417,0.000036818,0.000035118,0.000034938,0.000035459,0.000035276,0.000035227,0.000035370,0.000034621,0.000035262,0.000037247,0.000037742,0.000039507,0.000042362,0.000039007,0.000040945,0.000057495,0.000062116}};

const double rochcor2012::mcor_bfer[16][24]={{0.000066516,0.000059481,0.000040573,0.000038882,0.000040466,0.000037487,0.000036258,0.000035151,0.000033673,0.000033415,0.000033889,0.000033684,0.000033367,0.000033907,0.000033183,0.000033951,0.000035907,0.000036275,0.000038297,0.000040487,0.000042171,0.000041247,0.000059557,0.000064709},
{0.000068456,0.000059963,0.000040996,0.000041205,0.000039508,0.000036666,0.000035379,0.000034705,0.000033520,0.000033223,0.000033292,0.000033200,0.000033236,0.000033182,0.000033146,0.000033643,0.000034800,0.000035682,0.000037320,0.000040024,0.000036911,0.000039367,0.000055007,0.000060386},
{0.000059342,0.000053748,0.000038626,0.000037699,0.000039686,0.000037312,0.000035755,0.000034800,0.000033664,0.000033377,0.000034019,0.000033716,0.000033786,0.000034414,0.000033617,0.000034113,0.000035283,0.000036679,0.000038037,0.000040115,0.000037047,0.000039304,0.000054591,0.000060217},
{0.000060767,0.000055279,0.000038850,0.000037640,0.000040439,0.000037110,0.000035776,0.000035312,0.000033740,0.000033429,0.000034163,0.000033936,0.000033840,0.000034076,0.000033254,0.000033775,0.000034915,0.000036321,0.000037705,0.000040319,0.000037427,0.000038807,0.000054894,0.000060955},
{0.000057912,0.000055568,0.000039378,0.000039305,0.000039600,0.000037020,0.000035605,0.000035073,0.000033871,0.000033378,0.000034134,0.000034014,0.000033839,0.000034142,0.000033305,0.000033978,0.000035367,0.000036314,0.000038323,0.000042893,0.000037623,0.000039266,0.000054440,0.000059565},
{0.000060494,0.000057664,0.000039998,0.000041262,0.000039666,0.000036471,0.000035601,0.000034508,0.000033651,0.000033112,0.000033722,0.000033436,0.000033449,0.000033670,0.000033153,0.000033553,0.000034595,0.000035904,0.000037067,0.000039618,0.000036893,0.000038973,0.000055258,0.000059276},
{0.000059774,0.000056341,0.000039582,0.000040962,0.000039679,0.000037055,0.000035603,0.000034596,0.000033444,0.000033126,0.000033358,0.000033473,0.000033453,0.000033422,0.000032766,0.000033465,0.000034634,0.000035607,0.000036629,0.000039256,0.000036811,0.000039278,0.000055009,0.000059133},
{0.000056708,0.000053999,0.000038459,0.000037402,0.000039910,0.000037367,0.000035882,0.000035115,0.000033590,0.000032872,0.000033779,0.000033712,0.000033503,0.000033607,0.000033216,0.000033517,0.000035425,0.000036199,0.000037670,0.000041573,0.000037784,0.000038857,0.000054201,0.000058200},
{0.000063125,0.000058405,0.000041076,0.000042230,0.000041498,0.000037631,0.000036194,0.000034845,0.000033723,0.000033562,0.000033944,0.000033569,0.000033793,0.000033893,0.000033447,0.000033827,0.000035275,0.000035890,0.000037389,0.000040610,0.000042924,0.000042199,0.000061586,0.000071279},
{0.000058914,0.000054900,0.000039454,0.000037749,0.000040604,0.000037832,0.000036245,0.000034937,0.000033622,0.000033150,0.000034078,0.000033049,0.000033390,0.000033098,0.000032808,0.000033091,0.000034623,0.000035392,0.000036456,0.000039154,0.000036998,0.000039611,0.000055701,0.000062301},
{0.000057176,0.000053832,0.000038794,0.000037437,0.000039645,0.000036971,0.000035900,0.000034632,0.000033626,0.000033316,0.000040178,0.000033367,0.000033576,0.000033352,0.000032909,0.000033492,0.000034615,0.000035747,0.000036669,0.000039246,0.000042741,0.000039832,0.000055341,0.000059538},
{0.000058900,0.000055168,0.000038943,0.000037590,0.000039999,0.000036611,0.000035555,0.000034848,0.000033303,0.000032930,0.000035607,0.000033385,0.000033644,0.000039842,0.000033109,0.000033458,0.000035393,0.000035866,0.000037222,0.000039855,0.000036781,0.000038882,0.000055239,0.000058993},
{0.000057876,0.000054176,0.000039194,0.000039306,0.000039765,0.000036761,0.000035670,0.000035219,0.000033734,0.000033138,0.000033916,0.000033680,0.000033686,0.000039574,0.000033234,0.000033519,0.000035294,0.000035915,0.000036723,0.000040213,0.000037043,0.000039193,0.000054449,0.000058157},
{0.000059841,0.000055557,0.000039889,0.000038001,0.000039794,0.000036609,0.000035817,0.000034672,0.000033695,0.000033270,0.000033527,0.000033259,0.000033285,0.000033416,0.000033352,0.000033986,0.000034892,0.000035892,0.000037184,0.000039542,0.000036604,0.000039091,0.000055462,0.000059611},
{0.000060304,0.000056619,0.000039965,0.000041551,0.000039403,0.000037001,0.000035933,0.000034606,0.000033689,0.000033069,0.000033773,0.000033418,0.000033046,0.000033276,0.000032994,0.000033342,0.000034314,0.000035771,0.000038477,0.000041584,0.000036846,0.000038438,0.000054916,0.000057649},
{0.000058675,0.000054511,0.000038938,0.000037965,0.000040035,0.000037190,0.000035885,0.000035107,0.000033730,0.000033106,0.000033836,0.000033551,0.000033578,0.000033856,0.000033203,0.000033546,0.000035373,0.000035838,0.000037984,0.000040846,0.000037456,0.000039068,0.000054599,0.000057556}};


const double rochcor2012::mcor_maer[16][24]={{0.000066516,0.000059481,0.000040573,0.000038882,0.000040466,0.000037487,0.000036258,0.000035151,0.000033673,0.000033415,0.000033889,0.000033684,0.000033367,0.000033907,0.000033183,0.000033951,0.000035907,0.000036275,0.000038297,0.000040487,0.000042171,0.000041247,0.000059557,0.000064709},
{0.000068456,0.000059963,0.000040996,0.000041205,0.000039508,0.000036666,0.000035379,0.000034705,0.000033520,0.000033223,0.000033292,0.000033200,0.000033236,0.000033182,0.000033146,0.000033643,0.000034800,0.000035682,0.000037320,0.000040024,0.000036911,0.000039367,0.000055007,0.000060386},
{0.000059342,0.000053748,0.000038626,0.000037699,0.000039686,0.000037312,0.000035755,0.000034800,0.000033664,0.000033377,0.000034019,0.000033716,0.000033786,0.000034414,0.000033617,0.000034113,0.000035283,0.000036679,0.000038037,0.000040115,0.000037047,0.000039304,0.000054591,0.000060217},
{0.000060767,0.000055279,0.000038850,0.000037640,0.000040439,0.000037110,0.000035776,0.000035312,0.000033740,0.000033429,0.000034163,0.000033936,0.000033840,0.000034076,0.000033254,0.000033775,0.000034915,0.000036321,0.000037705,0.000040319,0.000037427,0.000038807,0.000054894,0.000060955},
{0.000057912,0.000055568,0.000039378,0.000039305,0.000039600,0.000037020,0.000035605,0.000035073,0.000033871,0.000033378,0.000034134,0.000034014,0.000033839,0.000034142,0.000033305,0.000033978,0.000035367,0.000036314,0.000038323,0.000042893,0.000037623,0.000039266,0.000054440,0.000059565},
{0.000060494,0.000057664,0.000039998,0.000041262,0.000039666,0.000036471,0.000035601,0.000034508,0.000033651,0.000033112,0.000033722,0.000033436,0.000033449,0.000033670,0.000033153,0.000033553,0.000034595,0.000035904,0.000037067,0.000039618,0.000036893,0.000038973,0.000055258,0.000059276},
{0.000059774,0.000056341,0.000039582,0.000040962,0.000039679,0.000037055,0.000035603,0.000034596,0.000033444,0.000033126,0.000033358,0.000033473,0.000033453,0.000033422,0.000032766,0.000033465,0.000034634,0.000035607,0.000036629,0.000039256,0.000036811,0.000039278,0.000055009,0.000059133},
{0.000056708,0.000053999,0.000038459,0.000037402,0.000039910,0.000037367,0.000035882,0.000035115,0.000033590,0.000032872,0.000033779,0.000033712,0.000033503,0.000033607,0.000033216,0.000033517,0.000035425,0.000036199,0.000037670,0.000041573,0.000037784,0.000038857,0.000054201,0.000058200},
{0.000063125,0.000058405,0.000041076,0.000042230,0.000041498,0.000037631,0.000036194,0.000034845,0.000033723,0.000033562,0.000033944,0.000033569,0.000033793,0.000033893,0.000033447,0.000033827,0.000035275,0.000035890,0.000037389,0.000040610,0.000042924,0.000042199,0.000061586,0.000071279},
{0.000058914,0.000054900,0.000039454,0.000037749,0.000040604,0.000037832,0.000036245,0.000034937,0.000033622,0.000033150,0.000034078,0.000033049,0.000033390,0.000033098,0.000032808,0.000033091,0.000034623,0.000035392,0.000036456,0.000039154,0.000036998,0.000039611,0.000055701,0.000062301},
{0.000057176,0.000053832,0.000038794,0.000037437,0.000039645,0.000036971,0.000035900,0.000034632,0.000033626,0.000033316,0.000040178,0.000033367,0.000033576,0.000033352,0.000032909,0.000033492,0.000034615,0.000035747,0.000036669,0.000039246,0.000042741,0.000039832,0.000055341,0.000059538},
{0.000058900,0.000055168,0.000038943,0.000037590,0.000039999,0.000036611,0.000035555,0.000034848,0.000033303,0.000032930,0.000035607,0.000033385,0.000033644,0.000039842,0.000033109,0.000033458,0.000035393,0.000035866,0.000037222,0.000039855,0.000036781,0.000038882,0.000055239,0.000058993},
{0.000057876,0.000054176,0.000039194,0.000039306,0.000039765,0.000036761,0.000035670,0.000035219,0.000033734,0.000033138,0.000033916,0.000033680,0.000033686,0.000039574,0.000033234,0.000033519,0.000035294,0.000035915,0.000036723,0.000040213,0.000037043,0.000039193,0.000054449,0.000058157},
{0.000059841,0.000055557,0.000039889,0.000038001,0.000039794,0.000036609,0.000035817,0.000034672,0.000033695,0.000033270,0.000033527,0.000033259,0.000033285,0.000033416,0.000033352,0.000033986,0.000034892,0.000035892,0.000037184,0.000039542,0.000036604,0.000039091,0.000055462,0.000059611},
{0.000060304,0.000056619,0.000039965,0.000041551,0.000039403,0.000037001,0.000035933,0.000034606,0.000033689,0.000033069,0.000033773,0.000033418,0.000033046,0.000033276,0.000032994,0.000033342,0.000034314,0.000035771,0.000038477,0.000041584,0.000036846,0.000038438,0.000054916,0.000057649},
{0.000058675,0.000054511,0.000038938,0.000037965,0.000040035,0.000037190,0.000035885,0.000035107,0.000033730,0.000033106,0.000033836,0.000033551,0.000033578,0.000033856,0.000033203,0.000033546,0.000035373,0.000035838,0.000037984,0.000040846,0.000037456,0.000039068,0.000054599,0.000057556}};


const double rochcor2012::dmavg[16][24]={{0.026080596,0.025756526,0.025478814,0.025199014,0.025049269,0.024930451,0.024994922,0.024931277,0.025089697,0.025258544,0.025407476,0.025520267,0.025509193,0.025391353,0.025238701,0.025066389,0.025006124,0.024957564,0.024969813,0.025001685,0.025205595,0.025434396,0.025874372,0.026088040},
{0.025968617,0.025763335,0.025493320,0.025138236,0.024927142,0.024964771,0.024984275,0.025017710,0.025119142,0.025224812,0.025448658,0.025595839,0.025496563,0.025384306,0.025208006,0.025098577,0.024977045,0.024938810,0.024997594,0.025005039,0.025094554,0.025428090,0.025730539,0.026028221},
{0.025894689,0.025560259,0.025307605,0.025003691,0.025010465,0.024945126,0.025024713,0.025081030,0.025150173,0.025374281,0.025452073,0.025583840,0.025637389,0.025490758,0.025269103,0.025128787,0.025014461,0.024953074,0.024938595,0.024893725,0.025166767,0.025263586,0.025733316,0.025859339},
{0.026081106,0.025699157,0.025381846,0.025113132,0.024956125,0.024893621,0.024903847,0.025030651,0.025129473,0.025349320,0.025479332,0.025631684,0.025604956,0.025487579,0.025354641,0.025191016,0.025004254,0.024985798,0.024893186,0.024870410,0.025076121,0.025263197,0.025600288,0.026003447},
{0.025860019,0.025664716,0.025360906,0.025008297,0.024899671,0.024900260,0.024965813,0.025016052,0.025137316,0.025316143,0.025479186,0.025596335,0.025616907,0.025465548,0.025357747,0.025166730,0.025094465,0.025018577,0.024943584,0.025005268,0.025073478,0.025333668,0.025627257,0.025837745},
{0.026008661,0.025742696,0.025380680,0.025139838,0.025044225,0.024966965,0.024907945,0.025076140,0.025114684,0.025310066,0.025368733,0.025518322,0.025519381,0.025430344,0.025241320,0.025148479,0.025051904,0.024957368,0.024912877,0.025021718,0.025099127,0.025386021,0.025566466,0.025940304},
{0.026107484,0.025795963,0.025423606,0.025213283,0.025112797,0.024957302,0.024968924,0.025015641,0.025108677,0.025275405,0.025383636,0.025530437,0.025542053,0.025459029,0.025329680,0.025120598,0.025020941,0.025009404,0.024958000,0.025017385,0.025163285,0.025403218,0.025664312,0.026005122},
{0.026099441,0.025791754,0.025438223,0.025140828,0.024967791,0.024972638,0.024886645,0.025061340,0.025148053,0.025223738,0.025458548,0.025583524,0.025603136,0.025383243,0.025326771,0.025194191,0.025110847,0.024979962,0.025012516,0.025106961,0.025166388,0.025394769,0.025589668,0.025999992},
{0.026110391,0.025903183,0.025455931,0.025198430,0.025077037,0.024941907,0.024907796,0.025034763,0.025071346,0.025246845,0.025462308,0.025378518,0.025496940,0.025437066,0.025276998,0.025109467,0.024965675,0.025030483,0.025030039,0.025027022,0.025212164,0.025439460,0.025726520,0.026022669},
{0.026128866,0.025796557,0.025501964,0.025282652,0.025042911,0.024977119,0.024941259,0.024979897,0.025080760,0.025153615,0.025213049,0.025452523,0.025477252,0.025389483,0.025262241,0.025211445,0.025009151,0.024937005,0.024957650,0.025058419,0.025145107,0.025352014,0.025674744,0.025895172},
{0.025901372,0.025749745,0.025415741,0.025169617,0.025064049,0.024921535,0.024991632,0.024974505,0.025080279,0.025236647,0.025526940,0.025491182,0.025542189,0.025452181,0.025332386,0.025140047,0.025090238,0.024986226,0.024934900,0.025023525,0.025144693,0.025356708,0.025695496,0.025953523},
{0.025989712,0.025639722,0.025370604,0.025163453,0.025010451,0.024941692,0.024920132,0.025014704,0.025085555,0.025308945,0.025406329,0.025499016,0.025616856,0.025283122,0.025246802,0.025147690,0.025001323,0.025048296,0.024902334,0.025034177,0.025115454,0.025417698,0.025681480,0.025983658},
{0.026030427,0.025708337,0.025406219,0.025127284,0.024994863,0.025019025,0.024987868,0.024977076,0.025131014,0.025303060,0.025381065,0.025501105,0.025453335,0.025539744,0.025284211,0.025112542,0.025048421,0.025014019,0.024987540,0.024995415,0.025238716,0.025376623,0.025728178,0.026005852},
{0.026011968,0.025799875,0.025463723,0.025169872,0.025008409,0.024987531,0.024972195,0.024965469,0.025085921,0.025307266,0.025343057,0.025518159,0.025519485,0.025351170,0.025227397,0.025139094,0.024987362,0.025016356,0.024943675,0.024984999,0.025126909,0.025420203,0.025791088,0.025852738},
{0.025969974,0.025850462,0.025467355,0.025232039,0.025041204,0.024958808,0.025012633,0.025068487,0.025049036,0.025266369,0.025406480,0.025468886,0.025549720,0.025412584,0.025241440,0.025178086,0.025037467,0.024948686,0.024939846,0.024981489,0.025132685,0.025425719,0.025720957,0.025965679},
{0.025995248,0.025724696,0.025472022,0.025109828,0.024949221,0.024922292,0.024887686,0.024946200,0.025109850,0.025288700,0.025446287,0.025584983,0.025650656,0.025453793,0.025320159,0.025134392,0.025069073,0.024946888,0.024995685,0.025020400,0.025123667,0.025461616,0.025635988,0.025922624}};

const double rochcor2012::dpavg[16][24]={{0.026119233,0.025845331,0.025569306,0.025264940,0.025004735,0.024929242,0.025016091,0.025070124,0.025110358,0.025269122,0.025502509,0.025530968,0.025554199,0.025390658,0.025222157,0.025071668,0.025045182,0.024989514,0.024928256,0.025003683,0.025260403,0.025577409,0.025938979,0.026189665},
{0.026123661,0.025748611,0.025433529,0.025167537,0.024967842,0.024913027,0.024989245,0.025030658,0.025212175,0.025322156,0.025441081,0.025536070,0.025543668,0.025434260,0.025300043,0.025080674,0.024972780,0.024952866,0.024932807,0.025009232,0.025163083,0.025453919,0.025821637,0.026057975},
{0.025968646,0.025644443,0.025338356,0.025057325,0.024974227,0.024955184,0.024934429,0.025012366,0.025178822,0.025247071,0.025461397,0.025648021,0.025547418,0.025546931,0.025307288,0.025221572,0.025009751,0.024909668,0.024939999,0.024927793,0.025120018,0.025380461,0.025786597,0.025944462},
{0.026053693,0.025703755,0.025347917,0.025050423,0.024861018,0.024813104,0.024949947,0.025033945,0.025143787,0.025356963,0.025503093,0.025572779,0.025620972,0.025482318,0.025319234,0.025236172,0.025069580,0.025017915,0.024916561,0.025003777,0.025053518,0.025355673,0.025622358,0.026061070},
{0.026088584,0.025793194,0.025437753,0.025210011,0.025017736,0.024824034,0.024956660,0.025055078,0.025201989,0.025341742,0.025538919,0.025646998,0.025665612,0.025525001,0.025409528,0.025168012,0.025147325,0.024976113,0.024952744,0.025079813,0.025207436,0.025386580,0.025710492,0.025943308},
{0.026187769,0.025729772,0.025498589,0.025287413,0.025039827,0.025002992,0.024967095,0.025013994,0.025152393,0.025277948,0.025420791,0.025578909,0.025513039,0.025427510,0.025261236,0.025156671,0.025045100,0.024990058,0.024894457,0.025070448,0.025210692,0.025485819,0.025877898,0.025975476},
{0.026083081,0.025821954,0.025530082,0.025211543,0.025119972,0.024948636,0.024946451,0.025069323,0.025131998,0.025309780,0.025425584,0.025574258,0.025576808,0.025408329,0.025308586,0.025132402,0.025004078,0.024986237,0.024924134,0.025071418,0.025148102,0.025427147,0.025743497,0.026121618},
{0.026242838,0.025880660,0.025537146,0.025239274,0.024975216,0.024878755,0.024879949,0.024986365,0.025128964,0.025257864,0.025412662,0.025537137,0.025637465,0.025420450,0.025298164,0.025136806,0.025026666,0.024959607,0.025007452,0.025037989,0.025208603,0.025526283,0.025825149,0.026141857},
{0.026254790,0.025931982,0.025574419,0.025301662,0.025063032,0.024962909,0.024903555,0.025022463,0.025130213,0.025259533,0.025466329,0.025506853,0.025601682,0.025449235,0.025247579,0.025086195,0.025020021,0.024975930,0.025029293,0.024977331,0.025256210,0.025479502,0.025848773,0.026071819},
{0.026283890,0.025929783,0.025590795,0.025290094,0.025096606,0.024995301,0.024926311,0.025015262,0.025133606,0.025281434,0.025331932,0.025511426,0.025462598,0.025329572,0.025252130,0.025122343,0.025022703,0.024964723,0.025009805,0.024967130,0.025273338,0.025508020,0.025875636,0.026125762},
{0.026147286,0.025748803,0.025489813,0.025128159,0.025025580,0.024907669,0.024975910,0.025078231,0.025138993,0.025315450,0.025509537,0.025478695,0.025588734,0.025436570,0.025290305,0.025162355,0.024930628,0.024931924,0.024928197,0.024972709,0.025182251,0.025415513,0.025755102,0.026010155},
{0.026092860,0.025841218,0.025459996,0.025247619,0.025010148,0.024894832,0.024981677,0.025032509,0.025179922,0.025267706,0.025324324,0.025539830,0.025504422,0.025533305,0.025300518,0.025108062,0.025055179,0.024972382,0.024899479,0.025059219,0.025217223,0.025419138,0.025764721,0.025997602},
{0.026123137,0.025854329,0.025540615,0.025189771,0.024907242,0.024934723,0.024927716,0.025022452,0.025141414,0.025209645,0.025450809,0.025534932,0.025555083,0.025391751,0.025261102,0.025194409,0.025023758,0.025033593,0.024963217,0.024979791,0.025184615,0.025524022,0.025753604,0.026092869},
{0.026232668,0.025864875,0.025581605,0.025304814,0.025096413,0.024994030,0.024961269,0.024953415,0.025065381,0.025308803,0.025323844,0.025534041,0.025533422,0.025365425,0.025253406,0.025078614,0.025027307,0.024925035,0.024971339,0.025019275,0.025123430,0.025423187,0.025868378,0.026062477},
{0.026150373,0.025790164,0.025476994,0.025265798,0.025001289,0.024937902,0.025068643,0.024993621,0.025116303,0.025254939,0.025441961,0.025514527,0.025568781,0.025481590,0.025219697,0.025134465,0.025059286,0.024979934,0.024891434,0.024969445,0.025204892,0.025400424,0.025744157,0.026074356},
{0.026084693,0.025742778,0.025366448,0.025129432,0.025019615,0.025018916,0.024956319,0.025029762,0.025123004,0.025330624,0.025475758,0.025547356,0.025600058,0.025451885,0.025276603,0.025103586,0.025038263,0.025044277,0.025002992,0.025041980,0.025138060,0.025481577,0.025789761,0.026096805}};

const double rochcor2012::mmavg[16][24]={{0.026076143,0.025722378,0.025355515,0.025144259,0.025023434,0.024892315,0.024948213,0.024986653,0.025158515,0.025273883,0.025395949,0.025446926,0.025429428,0.025318574,0.025207844,0.025092064,0.024973976,0.024994759,0.024990763,0.024978526,0.025168445,0.025478639,0.025692840,0.026019979},
{0.025828361,0.025687288,0.025363666,0.025163111,0.024978886,0.024888317,0.024994005,0.024997018,0.025077388,0.025354469,0.025425510,0.025569352,0.025510337,0.025386101,0.025192916,0.025030130,0.024962962,0.024913095,0.024907109,0.024934484,0.025180172,0.025365897,0.025629058,0.026016114},
{0.025874418,0.025632588,0.025347228,0.025082179,0.024896988,0.024879656,0.024904906,0.025107555,0.025200170,0.025362902,0.025491266,0.025592952,0.025612911,0.025499164,0.025264787,0.025099884,0.025001624,0.024885354,0.024909159,0.024949857,0.025167116,0.025424850,0.025713974,0.025934307},
{0.025936504,0.025612143,0.025262988,0.025058932,0.024885925,0.024851425,0.024976093,0.025063846,0.025196330,0.025385277,0.025511150,0.025731590,0.025704928,0.025488118,0.025332665,0.025198018,0.025022551,0.025054319,0.024868344,0.024882688,0.025086517,0.025285098,0.025604684,0.026025614},
{0.025934838,0.025691917,0.025300375,0.025117444,0.024867241,0.024911080,0.024913369,0.024954264,0.025143826,0.025347737,0.025485590,0.025643076,0.025692517,0.025510860,0.025366544,0.025176064,0.025083013,0.025010221,0.024968945,0.024967657,0.025127489,0.025316859,0.025546704,0.025858116},
{0.025915442,0.025740553,0.025287305,0.025098957,0.024998436,0.024914600,0.024931700,0.025003021,0.025138972,0.025270939,0.025472664,0.025529672,0.025542416,0.025497090,0.025252901,0.025110200,0.024967519,0.024959600,0.024965767,0.024930096,0.025136272,0.025373139,0.025685853,0.025977873},
{0.025997483,0.025922641,0.025445854,0.025113654,0.024940500,0.024954252,0.024955761,0.025070694,0.025133608,0.025311701,0.025404927,0.025552607,0.025605113,0.025462781,0.025307102,0.025145544,0.024978606,0.024921793,0.024889467,0.025006413,0.025191520,0.025355081,0.025742102,0.025899873},
{0.026022511,0.025703282,0.025371456,0.025139022,0.024994998,0.024951813,0.024849918,0.025045024,0.025090125,0.025309134,0.025426112,0.025570427,0.025472114,0.025500441,0.025320408,0.025126946,0.025047720,0.024955224,0.024947417,0.024997564,0.025176776,0.025353613,0.025696770,0.025956419},
{0.026068497,0.025790520,0.025355890,0.025129707,0.024995241,0.024956657,0.024912462,0.024972890,0.025102588,0.025274171,0.025407779,0.025458478,0.025517109,0.025423189,0.025259008,0.025133897,0.025024965,0.024982474,0.024951278,0.025073783,0.025113681,0.025402510,0.025537294,0.026144644},
{0.025919014,0.025838841,0.025454680,0.025115314,0.025000622,0.024831126,0.024954637,0.024942816,0.025105147,0.025254010,0.025285199,0.025424953,0.025538029,0.025399597,0.025250618,0.025164201,0.025007642,0.024926447,0.024893145,0.025002110,0.025008431,0.025385063,0.025675196,0.025903810},
{0.025946932,0.025704528,0.025418871,0.025169890,0.024993267,0.025055153,0.024889287,0.025044621,0.025093468,0.025287213,0.025475092,0.025564380,0.025567701,0.025435619,0.025330779,0.025142926,0.025012577,0.024976384,0.024937962,0.025030760,0.025161646,0.025393659,0.025675083,0.025907595},
{0.026003687,0.025643614,0.025356034,0.025123526,0.024975727,0.024979629,0.024916953,0.024999342,0.025137635,0.025249099,0.025509915,0.025604914,0.025605148,0.025387766,0.025338471,0.025202564,0.025009713,0.024928145,0.024922141,0.024974447,0.025061054,0.025408949,0.025520122,0.026010159},
{0.025936469,0.025661464,0.025426659,0.025140280,0.024985168,0.024873958,0.024928735,0.025005719,0.025118085,0.025248262,0.025443656,0.025523003,0.025515283,0.025530855,0.025247342,0.025113097,0.024960984,0.024947133,0.024921496,0.025057534,0.025087062,0.025275955,0.025691383,0.026143818},
{0.025882212,0.025731697,0.025440894,0.025093762,0.024908033,0.024995830,0.024950139,0.024944598,0.025093711,0.025226174,0.025422490,0.025486587,0.025517528,0.025432367,0.025231487,0.025097135,0.024996484,0.024941912,0.024892896,0.024908085,0.025168827,0.025386181,0.025670342,0.025886640},
{0.026187807,0.025763347,0.025479396,0.025174726,0.024936770,0.024942942,0.024980914,0.024979491,0.025091549,0.025225951,0.025473540,0.025549384,0.025580544,0.025416812,0.025252270,0.025143788,0.025023889,0.024984223,0.024990288,0.025045658,0.025069695,0.025530423,0.025726424,0.025977225},
{0.026031924,0.025750460,0.025448474,0.025101205,0.024958588,0.024907084,0.024863468,0.025040119,0.025095172,0.025264237,0.025498407,0.025562268,0.025548341,0.025528491,0.025227412,0.025130176,0.025040158,0.024844308,0.024877231,0.024961673,0.025121269,0.025394931,0.025635157,0.025943260}};

const double rochcor2012::mpavg[16][24]={{0.026298533,0.025720994,0.025517069,0.025164453,0.024985835,0.024897968,0.024952956,0.024990044,0.025155664,0.025294039,0.025459473,0.025463296,0.025474365,0.025395773,0.025236277,0.025084887,0.025035611,0.024968269,0.024863091,0.025024502,0.025279983,0.025508218,0.025894534,0.026035488},
{0.025948916,0.025804821,0.025351128,0.025117848,0.025047072,0.024948276,0.024906131,0.025022145,0.025146905,0.025297460,0.025485364,0.025545567,0.025553833,0.025439861,0.025274182,0.025105997,0.024969961,0.024925989,0.024914220,0.024927486,0.025093253,0.025451571,0.025804143,0.026070193},
{0.025995053,0.025652053,0.025453153,0.025106947,0.025008426,0.024871445,0.024912002,0.025015382,0.025158112,0.025361887,0.025555083,0.025585246,0.025644324,0.025437395,0.025323756,0.025137466,0.024986832,0.024947952,0.024960875,0.024912166,0.025150146,0.025395293,0.025775345,0.026134056},
{0.026006027,0.025693430,0.025416382,0.025048027,0.024884971,0.024835176,0.024900940,0.025012234,0.025113475,0.025323285,0.025596164,0.025612068,0.025700247,0.025606808,0.025381733,0.025187196,0.025021636,0.025007475,0.024968596,0.024917670,0.025139467,0.025349774,0.025566409,0.026028473},
{0.026164873,0.025757797,0.025482106,0.025045252,0.024961259,0.024872991,0.024991102,0.024987485,0.025231110,0.025281482,0.025550063,0.025636563,0.025681198,0.025605548,0.025421613,0.025179582,0.025085215,0.024953436,0.024934232,0.025011053,0.025111543,0.025370824,0.025807938,0.025967839},
{0.026140668,0.025679682,0.025461249,0.025198842,0.024998549,0.024903651,0.024959323,0.025043885,0.025163921,0.025318477,0.025470087,0.025539793,0.025631807,0.025415573,0.025303637,0.025132052,0.025036538,0.024929278,0.024968882,0.024989607,0.025122112,0.025526542,0.025704221,0.026041834},
{0.026087985,0.025641596,0.025483899,0.025231306,0.025074559,0.024976729,0.024894613,0.024965643,0.025126101,0.025216110,0.025435298,0.025582262,0.025647221,0.025420777,0.025348154,0.025073399,0.024953868,0.024883545,0.024985995,0.024994780,0.025107398,0.025450866,0.025756867,0.025987793},
{0.026099963,0.025841433,0.025362252,0.025113489,0.025001684,0.024943657,0.024970140,0.024904929,0.025111544,0.025259292,0.025418891,0.025584732,0.025584271,0.025460791,0.025292958,0.025091623,0.025005268,0.024970805,0.024985434,0.024957654,0.025163934,0.025466233,0.025848174,0.026106751},
{0.026189547,0.025836200,0.025464915,0.025157229,0.024979193,0.024957712,0.025001780,0.025085998,0.025099485,0.025225775,0.025390329,0.025608703,0.025555496,0.025510796,0.025204917,0.025122810,0.025027743,0.024914656,0.024949148,0.025012627,0.025194800,0.025591224,0.025841180,0.026113209},
{0.026155862,0.025914721,0.025554899,0.025163951,0.024952267,0.024927885,0.024893959,0.025005937,0.025079675,0.025253512,0.025496346,0.025580553,0.025549665,0.025314352,0.025281460,0.025125716,0.024966268,0.024957620,0.025001232,0.025067615,0.025094753,0.025360502,0.025775874,0.026148877},
{0.026200022,0.025734256,0.025453169,0.025156766,0.024967990,0.024931650,0.024857412,0.024969547,0.025133849,0.025264804,0.025612586,0.025629388,0.025579344,0.025504967,0.025321703,0.025075660,0.025024196,0.024892811,0.024853361,0.024949236,0.025241054,0.025436938,0.025844180,0.025972050},
{0.026107975,0.025855792,0.025433089,0.025162705,0.024930415,0.024919623,0.024857955,0.025040908,0.025132493,0.025248163,0.025408424,0.025657993,0.025562038,0.025529589,0.025290313,0.025109548,0.025067410,0.024935211,0.024880038,0.025010858,0.025195284,0.025463067,0.025828313,0.026101543},
{0.026209695,0.025813203,0.025483721,0.025168332,0.024938023,0.024932823,0.024974450,0.025015009,0.025139312,0.025326014,0.025479464,0.025579171,0.025628388,0.025497013,0.025301501,0.025216906,0.025052264,0.025006134,0.024932508,0.024995107,0.025109879,0.025455123,0.025758574,0.026061662},
{0.026198720,0.025982908,0.025508774,0.025214995,0.025061370,0.024872333,0.024980138,0.024980058,0.025055398,0.025323292,0.025425741,0.025543674,0.025573697,0.025402257,0.025226468,0.025071536,0.025006743,0.024940502,0.024938495,0.024957202,0.025098192,0.025384088,0.025766436,0.026011078},
{0.026187300,0.025720965,0.025405629,0.025222245,0.025029665,0.024925801,0.025005635,0.024952386,0.025127793,0.025263970,0.025505194,0.025567565,0.025553158,0.025430697,0.025288814,0.025105628,0.024969527,0.024961522,0.024970897,0.025040893,0.025031192,0.025495526,0.025776930,0.026116737},
{0.026105006,0.025757175,0.025475465,0.025115075,0.025064772,0.024928252,0.024935849,0.025015772,0.025133281,0.025347392,0.025461565,0.025546864,0.025564299,0.025452182,0.025240673,0.025046207,0.025010977,0.024911699,0.024921075,0.025024559,0.025153944,0.025537100,0.025845433,0.026130081}};


//==========================================================================================================================


const double rochcor2012::sf[3] = {0.00584301,-0.000109053,0.00151709};
const double rochcor2012::sfer[3] = {0.000239709,0.000143222,0.000121206};

const double rochcor2012::dd[12]={0.00507658,0.00450699,0.00520952,0.00673444,0.00818052,0.0118082,0.00715062,0.00452796,0.00293864,0.00680112,0.0139185+0.00164779,0.0158812};
const double rochcor2012::dder[12]={4.11857e-05,4.71802e-05,4.82681e-05,5.23752e-05,6.10572e-05,7.91374e-05,9.49462e-05,0.000107722,0.000124342,0.000158863,0.000339009,0.00183629};

const double rochcor2012::md[12]={0.000941338,0.00112918,0.00110261,0.00362952,0.00465242,0.00894214,0.00399059,0.00124392,0.00560536,0.00966376,0.0141334,0.0211297};
const double rochcor2012::mder[12]={3.84139e-05,4.34656e-05,4.32385e-05,4.65743e-05,5.76587e-05,7.56584e-05,8.89012e-05,0.000102884,0.000116726,0.000155305,0.000331034,0.00185912};

const double rochcor2012::dscl[24]={1.00014,1.0001,0.999735,0.999477,0.999464,0.999764,0.999817,0.999738,0.999954,1.00019,1.00036,1.00052,1.00033,1.00026,0.999813,0.999691,0.999646,0.999423,0.999881,0.999667,0.999457,1.00018,1.0001,1.00121};
const double rochcor2012::mscl[24]={0.99927,0.999942,1.00012,0.999918,0.999911,1.00005,1.00015,1.00006,0.999928,0.999994,0.999916,1.00006,0.999995,0.999994,1.00006,1.00004,0.999893,0.999894,1.00014,0.999971,1.00008,0.999933,0.99961,0.999268};

muresolution muresol;

//===============================================================================================

rochcor2012::~rochcor2012(){
}

rochcor2012::rochcor2012(){
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2012::rochcor2012(int seed){
  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2012::momcor_mc( TLorentzVector& mu, float charge, int ntrk, float& qter){
  
  //sysdev == num : deviation = num

  double ptmu = mu.Pt();
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root

  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    double Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*ptmu);
    
    //for the momentum tuning - eta,phi,Q correction
    px *= cor;
    py *= cor;
    pz *= cor;
    e  *= cor;

    double gscler = mgscl_stat;    
    double gscl = (genm_smr/mrecm);
    
    px *= (gscl + gscler_mc_dev*gscler);
    py *= (gscl + gscler_mc_dev*gscler);
    pz *= (gscl + gscler_mc_dev*gscler);
    e  *= (gscl + gscler_mc_dev*gscler);
        
    double tune = muresol.kSmear(sqrt(px*px+py*py),mueta,ntrk,muresolution::Extra);
    
    px *= (tune*mscl[mu_etabin]); 
    py *= (tune*mscl[mu_etabin]);  
    pz *= (tune*mscl[mu_etabin]);  
    e  *= (tune*mscl[mu_etabin]);   
    
        
    double pt = sqrt(px*px + py*py);
    double pt_tune = (pt-md[mu_aetabin])*45.0/(45.0-md[mu_aetabin]);

    px *= (pt_tune/pt); 
    py *= (pt_tune/pt);  
    pz *= (pt_tune/pt);  
    e  *= (pt_tune/pt);   
    

    double momscl = sqrt(px*px + py*py)/ptmu;
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
    
    
  }
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}


void rochcor2012::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  double ptmu = mu.Pt();

  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root

  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);

  if(mu_phibin>=0 && mu_etabin>=0){

    double Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    double Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*ptmu);
    
    px *= cor;
    py *= cor;
    pz *= cor;
    e  *= cor;
    
    //after Z pt correction
    double gscler = dgscl_stat;
    double gscl = (genm_smr/drecm);
    
    px *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    py *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    pz *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    e  *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];


    double pt = sqrt(px*px + py*py);
    double pt_tune = (pt-dd[mu_aetabin])*45.0/(45.0-dd[mu_aetabin]);

    px *= (pt_tune/pt); 
    py *= (pt_tune/pt);  
    pz *= (pt_tune/pt);  
    e  *= (pt_tune/pt);   


    double momscl = sqrt(px*px + py*py)/ptmu;
    qter *= momscl;

  }
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}

Int_t rochcor2012::phibin(double phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2012::etabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}



Int_t rochcor2012::aetabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<12; i++){
    if(anetabin[i] <= fabs(eta) && anetabin[i+1] > fabs(eta)){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

